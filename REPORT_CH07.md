
## 7장 . 도커컴포즈로 분산 어플리케이션 실행하기

## 학습 ##

# 도커 컴포즈란?
- 도커컴포즈 파일은 어플리케이션이 실행중일때 어던 상태여야ㅑ\하는지를 기술하는 파일.
- dockcon run 했을때 옵션들을 한대 모아놓은 단순 형식 파일
- 도커컴포즈 파일을 만들면 도커 컴포즈 도구가 어플리케이션을 실행하고 컨테이너, 볼륨,마운트들 필요한 모든 도커 객체를 만들도록 도커API에 명령을 내린다.
- 도커컴포즈 파일은 YAML 문법으로 기술
- 3단계 최상위문으로 구성
  - version : 도커컴포즈 파일 형식의 버전 
  - services : 어플리케이션을 구성하는 모든 컴포넌트 열거
  - networks : 서비스 컨테이너가 연결될 모든 도커 네트워크 열겨
- docker-compose 를 실행하면 먼저 현재 작업 디렉터리에서 docker-compose.yml파일을 찾는다
- docker-compose.yml 마일은 소스코드로 dockerfile 스크립트와 함계 형상 관리 도구로 관리된다.
  - README 파일에 이미지 이름. 공개해야할 포드번호를 문서화할 필요가 아예 없어졌다!
  
# 도커 컴포즈의 한계
- 어플리케이션이 지속적으로 정의된 상태를 유지하도록 하는 기능이 ㅇ벗다.
- 일부컨테이너가 오류를 일으키거나 강제 종료되도 dockcom up 명령을 다시 실행하지 않으면 어플리케이션 상태를 원래대로 되돌릴 수 없음.


## 실습 ##
1. todo-list 어플리케이셔 이미지로 컨테이너 실행해 연결된 볼룸 확인하기
   - dockcon run -d -p 80:80 --name todo1 diamol/ch06-todo-list
   - dockcon inspect todo1
   - docker volume ls

2. 도커 컴포즈로 todo-list 올리기
    - postgres 연결
    - 바인드 마운트로 연결하여 재시동에도 데이터 유지 되도록
    - 도커 및 서버 재시작시 항상 자동 시작되도록 설정
    - ch07/lab/docker-compose.yml 참고
